[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-09-22 16:56:11.912258",
  "module": null,
  "name": "button translation script",
  "script": "/*frappe.ui.form.on('Item', {\r\n    refresh: function(frm) {\r\n        frm.add_custom_button(__('Translate to Arabic'), function() {\r\n            frappe.call({\r\n                method: \"sales_management.api.translator.translate_item_name\",\r\n                args: { item_name: frm.doc.item_name },\r\n                callback: function(r) {\r\n                    if (r.message) {\r\n                        frm.set_value('item_name_arabic', r.message);\r\n                        frappe.msgprint(__('Translation saved!'));\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    }\r\n});*/\r\n\r\n\r\nfrappe.ui.form.on('Item', {\r\n    refresh: function(frm) {\r\n        if (!frm.translate_button_added) {\r\n            frm.translate_button_added = true;\r\n\r\n            const wrapper = $(frm.fields_dict['item_name'].wrapper);\r\n\r\n            // Wrap input in input-group if not already\r\n            if (!wrapper.find('.input-group').length) {\r\n                wrapper.find('input').wrap('<div class=\"input-group\"></div>');\r\n            }\r\n\r\n            // Add the button\r\n            const btnHtml = `\r\n                <div class=\"input-group-append\">\r\n                    <button class=\"btn btn-primary btn-xs\" type=\"button\" id=\"translate-btn\" disabled>\r\n                        <i class=\"fa fa-language\"></i> Translate\r\n                    </button>\r\n                </div>\r\n            `;\r\n            wrapper.find('.input-group').append(btnHtml);\r\n\r\n            const $btn = $('#translate-btn');\r\n\r\n            // Function to toggle button based on field value\r\n            const toggleButton = () => {\r\n                if (frm.doc.item_name && frm.doc.item_name.trim() !== \"\") {\r\n                    $btn.prop('disabled', false);\r\n                } else {\r\n                    $btn.prop('disabled', true);\r\n                }\r\n            };\r\n\r\n            // Watch for user input\r\n            frm.fields_dict.item_name.$input.on('input', toggleButton);\r\n\r\n            // Watch for changes set programmatically\r\n            frm.fields_dict.item_name.df.onchange = toggleButton;\r\n\r\n            // Initial check\r\n            toggleButton();\r\n\r\n            // Button click handler with loader\r\n            $btn.click(function() {\r\n                const item_name = frm.doc.item_name;\r\n                if (!item_name) return;\r\n\r\n                $btn.prop('disabled', true);\r\n                $btn.html('<i class=\"fa fa-spinner fa-spin\"></i> Translating...');\r\n\r\n                frappe.call({\r\n                    method: \"sales_management.api.translator.translate_item_name\",\r\n                    args: { item_name: item_name },\r\n                    callback: function(r) {\r\n                        $btn.html('<i class=\"fa fa-language\"></i> Translate');\r\n                        toggleButton();\r\n\r\n                        if (r.message) {\r\n                            frm.set_value('item_name_arabic', r.message);\r\n                            frappe.msgprint(__('Translation saved!'));\r\n                        } else {\r\n                            frappe.msgprint(__('Translation failed'));\r\n                        }\r\n                    },\r\n                    error: function() {\r\n                        $btn.html('<i class=\"fa fa-language\"></i> Translate');\r\n                        toggleButton();\r\n                        frappe.msgprint(__('Translation failed'));\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    // Also check when item_name is set programmatically\r\n    item_name: function(frm) {\r\n        const $btn = $('#translate-btn');\r\n        if ($btn.length) {\r\n            if (frm.doc.item_name && frm.doc.item_name.trim() !== \"\") {\r\n                $btn.prop('disabled', false);\r\n            } else {\r\n                $btn.prop('disabled', true);\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n",
  "view": "Form"
 }
]